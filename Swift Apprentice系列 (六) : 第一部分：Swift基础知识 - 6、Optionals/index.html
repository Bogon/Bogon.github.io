<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.1">
<script data-ad-client="ca-pub-5714801576974230" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">
  <meta name="google-site-verification" content="G0fHOrfJn5sHWzmi6ZCcg2aX83myBc-9U1BJZJJDSTU">
  <meta name="baidu-site-verification" content="7gJOLignE2">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"www.xuebaonline.com","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":"flat"},"back2top":{"enable":true,"sidebar":false,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":true,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>


  <meta name="description" content="Swift Apprentice系列 (六) : 第一部分：Swift基础知识 - 6、Optionals">
<meta property="og:type" content="article">
<meta property="og:title" content="Swift Apprentice系列 (六) : 第一部分：Swift基础知识 - 6、Optionals">
<meta property="og:url" content="https://www.xuebaonline.com/Swift%20Apprentice%E7%B3%BB%E5%88%97%20(%E5%85%AD)%20:%20%E7%AC%AC%E4%B8%80%E9%83%A8%E5%88%86%EF%BC%9ASwift%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%20-%206%E3%80%81Optionals/index.html">
<meta property="og:site_name" content="Char&#39;s Blog">
<meta property="og:description" content="Swift Apprentice系列 (六) : 第一部分：Swift基础知识 - 6、Optionals">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://cdn.xuebaonline.com/sasb-o-stp1.png">
<meta property="og:image" content="http://cdn.xuebaonline.com/sasb-o-stp2.png">
<meta property="article:published_time" content="2020-05-12T09:35:23.000Z">
<meta property="article:modified_time" content="2021-12-18T11:29:26.138Z">
<meta property="article:author" content="Char">
<meta property="article:tag" content="iOS">
<meta property="article:tag" content="Swift">
<meta property="article:tag" content="Swift Apprentice">
<meta property="article:tag" content="Swift学习">
<meta property="article:tag" content="Swift进阶">
<meta property="article:tag" content="Protocols">
<meta property="article:tag" content="协议编程">
<meta property="article:tag" content="泛型">
<meta property="article:tag" content="编程">
<meta property="article:tag" content="多态">
<meta property="article:tag" content="Optionals">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://cdn.xuebaonline.com/sasb-o-stp1.png">

<link rel="canonical" href="https://www.xuebaonline.com/Swift%20Apprentice%E7%B3%BB%E5%88%97%20(%E5%85%AD)%20:%20%E7%AC%AC%E4%B8%80%E9%83%A8%E5%88%86%EF%BC%9ASwift%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%20-%206%E3%80%81Optionals/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>
<script data-ad-client="ca-pub-5714801576974230" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <title>Swift Apprentice系列 (六) : 第一部分：Swift基础知识 - 6、Optionals | Char's Blog</title>
  
    <script>
      function sendPageView() {
        if (CONFIG.hostname !== location.hostname) return;
        var uid = localStorage.getItem('uid') || (Math.random() + '.' + Math.random());
        localStorage.setItem('uid', uid);
        navigator.sendBeacon('https://www.google-analytics.com/collect', new URLSearchParams({
          v  : 1,
          tid: 'UA-165583776-1',
          cid: uid,
          t  : 'pageview',
          dp : encodeURIComponent(location.pathname)
        }));
      }
      document.addEventListener('pjax:complete', sendPageView);
      sendPageView();
    </script>


  <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?f44aa1d26d8ba6a20c1a09a9cdcd7e3d";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>




  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<link rel="alternate" href="/atom.xml" title="Char's Blog" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Char's Blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">如切如磋，如琢如磨。</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签<span class="badge">143</span></a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类<span class="badge">67</span></a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档<span class="badge">176</span></a>

  </li>
        <li class="menu-item menu-item-schedule">

    <a href="/schedule/" rel="section"><i class="fa fa-calendar fa-fw"></i>日程表</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://www.xuebaonline.com/Swift%20Apprentice%E7%B3%BB%E5%88%97%20(%E5%85%AD)%20:%20%E7%AC%AC%E4%B8%80%E9%83%A8%E5%88%86%EF%BC%9ASwift%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%20-%206%E3%80%81Optionals/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="http://cdn.xuebaonline.com/blog_avatar.JPG">
      <meta itemprop="name" content="Char">
      <meta itemprop="description" content="曾经沧海难为水，除却巫山不是云。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Char's Blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Swift Apprentice系列 (六) : 第一部分：Swift基础知识 - 6、Optionals
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-05-12 17:35:23" itemprop="dateCreated datePublished" datetime="2020-05-12T17:35:23+08:00">2020-05-12</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/iOS/" itemprop="url" rel="index"><span itemprop="name">iOS</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Swift/" itemprop="url" rel="index"><span itemprop="name">Swift</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Swift-Apprentice/" itemprop="url" rel="index"><span itemprop="name">Swift Apprentice</span></a>
                </span>
            </span>

          
            <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span id="busuanzi_value_page_pv"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/Swift%20Apprentice%E7%B3%BB%E5%88%97%20(%E5%85%AD)%20:%20%E7%AC%AC%E4%B8%80%E9%83%A8%E5%88%86%EF%BC%9ASwift%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%20-%206%E3%80%81Optionals/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/Swift%20Apprentice%E7%B3%BB%E5%88%97%20(%E5%85%AD)%20:%20%E7%AC%AC%E4%B8%80%E9%83%A8%E5%88%86%EF%BC%9ASwift%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%20-%206%E3%80%81Optionals/" itemprop="commentCount"></span>
    </a>
  </span>
  
  <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>6.8k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>6 分钟</span>
            </span>
            <div class="post-description">Swift Apprentice系列 (六) : 第一部分：Swift基础知识 - 6、Optionals</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>到目前为止，你处理的所有变量和常量都有具体的值。 当你有一个字符串变量（例如var name）时，它具有与之关联的字符串值，例如“ Hello Swift”。 它可能是一个空字符串，例如“”，但仍然可以引用一个值。</p>
<p>这就是Swift的内置安全功能之一：如果类型为Int或String，那么可以保证有一个实际的整数或字符串。</p>
<p>本章将向你介绍可选对象的概念，可选对象是一种特殊的Swift类型，它不仅可以表示值，还可以表示值的缺失。 在本章的最后，你将了解为什么需要可选选项以及如何安全地使用它们。</p>
<a id="more"></a>

<h1 id="介绍nil"><a href="#介绍nil" class="headerlink" title="介绍nil"></a><strong>介绍nil</strong></h1><p>有时，表示缺少值很有用。 设想一个场景，你需要参考一个人的身份信息； 你想存储此人的姓名，年龄和职业。 名称和年龄都是必须具有价值的东西-每个人都有。 但是并不是每个人都受雇，因此缺乏职业价值是你需要能够处理的。</p>
<p>在不知道选填项的情况下，这可能是你代表该人的姓名，年龄和职业的方式：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> name = <span class="string">"Hello Swift"</span></span><br><span class="line"><span class="keyword">var</span> age = <span class="number">30</span></span><br><span class="line"><span class="keyword">var</span> occupation = <span class="string">"Software Developer &amp; Author"</span></span><br></pre></td></tr></table></figure>

<p>但是，如果我失业了怎么办？ 也许我已经中了彩票，想完全放弃工作（我希望！）。 在这种情况下，能够引用缺少值会很有用。</p>
<p>你为什么不能只使用一个空字符串？ 你可以，但是可选是更好的解决方案。 继续阅读以了解原因。</p>
<h2 id="前哨值"><a href="#前哨值" class="headerlink" title="前哨值"></a><em><strong>前哨值</strong></em></h2><p><strong>表示特殊条件（例如缺少值）的值称为前哨值，或者简称为特殊值</strong>。 这就是上一个示例中的空字符串。</p>
<p>让我们看另一个例子。 假设你的代码向服务器请求了某些内容，然后使用变量来存储所有返回的错误代码：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> errorCode = <span class="number">0</span></span><br></pre></td></tr></table></figure>

<p>在成功的情况下，你表示没有零错误。这意味着0是一个前哨值。</p>
<p>就像占用空字符串一样，它可以工作，但是对于程序员而言，这可能会造成混乱，因为它会随意窃取值。 0实际上可能是有效的错误代码，或者如果服务器更改了响应方式，则可能在将来。无论哪种方式，如果不咨询有关特殊值的文档，你都无法完全确定服务器没有返回错误。</p>
<p>在这两个示例中，如果有一个特殊的类型可以表示缺少值，那就更好了。这样一来，当一个值存在而一个值不存在时，编译器便可以检查你了。</p>
<p><strong>Nil是缺少值的名称</strong>，你将了解Swift如何以一种相当优雅的方式将这个概念直接整合到语言中。</p>
<p>其他一些编程语言仅包含哨兵值。有些对象（如Objective-C）具有nil的概念，但这仅是nil的同义词。这只是另一个哨兵价值。</p>
<p>Swift引入了一个全新的可选类型，该类型处理值可能为零的可能性。如果你要处理的是非可选类型，则可以保证它具有值，而不必担心具有特殊含义的前哨值。同样，如果使用的是可选类型，则知道必须处理nil情况。它消除了使用前哨值引入的歧义。</p>
<h1 id="引入optionals"><a href="#引入optionals" class="headerlink" title="引入optionals"></a><strong>引入optionals</strong></h1><p>可选选项是Swift既代表值又不存在值的解决方案。 允许使用可选值来保存值或nil。</p>
<p>可以将可选内容视为一个框：它要么只包含一个值，要么为空。 如果不包含值，则表示包含nil。 盒子本身总是存在的。 它总是在那里供你打开并查看内部。</p>
<p><img src="http://cdn.xuebaonline.com/sasb-o-stp1.png" alt="playground"></p>
<p>另一方面，字符串或整数周围没有此框。 相反，总会有一个值，例如“ hello”或42。请记住，非可选类型必须保证具有实际值。</p>
<blockquote>
<p>注意：那些学习过物理的人可能现在正在思考薛定谔的猫。 可选方案有点类似，只是这不是生死攸关的问题！</p>
</blockquote>
<p>你可以使用以下语法声明可选类型的变量：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> errorCode: <span class="type">Int?</span></span><br></pre></td></tr></table></figure>

<p>此声明与标准声明之间的唯一区别是类型末尾的问号。 在这种情况下，errorCode是“可选的Int”。 这意味着变量本身就像一个包含Int或nil的盒子。</p>
<blockquote>
<p>注意：你可以在任何类型之后添加问号以创建可选类型。 据说此可选类型包装了常规的非可选类型。 例如，可选类型String？ 包装字符串类型。 换句话说：String类型的可选框？ 保存String或nil。<br>另外，请注意必须如何使用类型注释使可选类型显式（在这里：Int？）。 不能从初始化值推断出可选类型，因为这些值是常规，非可选类型或nil，可以与任何可选类型一起使用。</p>
</blockquote>
<p>设置值很简单。 你可以将其设置为Int，如下所示：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">errorCode = <span class="number">100</span></span><br></pre></td></tr></table></figure>

<p>或者你可以将其设置为nil，如下所示：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">errorCode = <span class="literal">nil</span></span><br></pre></td></tr></table></figure>

<p>此图可以帮助你直观地了解正在发生的事情：</p>
<p><img src="http://cdn.xuebaonline.com/sasb-o-stp2.png" alt="playground"></p>
<p>可选框始终存在。 当你为变量分配100时，你将在该框中填充值。 当你为变量分配nil时，你将清空该框。</p>
<p>花几分钟考虑一下这个概念。 当你阅读本章的其余部分并开始使用可选选项时，框类比将是一个很大的帮助。</p>
<h2 id="解包可选"><a href="#解包可选" class="headerlink" title="解包可选"></a><em><strong>解包可选</strong></em></h2><p>可选参数的存在是件好事，但你可能想知道如何查看框内的内容并操纵其中包含的值。</p>
<p>看看打印出可选值时会发生什么：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> result: <span class="type">Int?</span> = <span class="number">30</span></span><br><span class="line"><span class="built_in">print</span>(result)</span><br></pre></td></tr></table></figure>

<p>打印以下内容：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Optional</span>(<span class="number">30</span>)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>注意：你还将在此行上看到一条警告，提示“表达式从’Int？隐式强制’。 去任何”。 这是因为Swift会警告你在Any类型的位置使用了可选参数，因为这通常意味着你做错了什么。 要使警告静音，你可以将代码更改为print（结果为Any）。</p>
</blockquote>
<p>那不是你真正想要的-尽管如果你考虑一下，那是有道理的。 你的代码已打印该框。 结果说：“结果是一个可选值，包含值30”。</p>
<p>若要查看可选类型与非可选类型的区别，请查看如果尝试使用结果（就像普通整数一样）会发生什么：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(result + <span class="number">1</span>)</span><br></pre></td></tr></table></figure>

<p>此代码触发错误：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Value</span> of <span class="keyword">optional</span> type '<span class="type">Int?</span>' must be unwrapped to a value of</span><br><span class="line">type '<span class="type">Int'</span></span><br></pre></td></tr></table></figure>

<p>它不起作用，因为你正尝试向框中添加一个整数，而不是向框中的值添加一个整数，而是向框本身添加一个整数。 那没有道理。</p>
<h2 id="强制解包"><a href="#强制解包" class="headerlink" title="强制解包"></a><em><strong>强制解包</strong></em></h2><p>错误消息给出了解决方案的指示：它告诉你必须将可选包装拆开。 你需要从框中解开该值。 就像圣诞节！</p>
<p>让我们看看它是如何工作的。 请考虑以下声明：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> authorName: <span class="type">String?</span> = <span class="string">"Matt Galloway"</span></span><br><span class="line"><span class="keyword">var</span> authorAge: <span class="type">Int?</span> = <span class="number">30</span></span><br></pre></td></tr></table></figure>

<p>你可以使用两种不同的方法来解开这些可选选项。 第一个称为强制展开，你可以这样执行：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> unwrappedAuthorName = authorName!</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"Author is \(unwrappedAuthorName)"</span>)</span><br></pre></td></tr></table></figure>

<p>此代码打印：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Author</span> <span class="keyword">is</span> <span class="type">Matt</span> <span class="type">Galloway</span></span><br></pre></td></tr></table></figure>

<p>这就是你的期望。</p>
<p>变量名称后的感叹号告诉编译器你想在框内查看并取出该值。 结果是包装类型的值。 这意味着unwrappedAuthorName的类型为String，而不是String?。</p>
<p>使用“ force”一词和感叹号！ 可能会向你传达一种危险感，应该这样。</p>
<p>你应该谨慎使用“ force”。 要了解原因，请考虑当可选值不包含值时会发生什么情况：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">authorName = <span class="literal">nil</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">"Author is \(authorName!)"</span>)</span><br></pre></td></tr></table></figure>

<p>此代码产生以下错误，你将在控制台中看到该错误：</p>
<blockquote>
<p>发生错误是因为变量在尝试展开时不包含任何值。 更糟糕的是，你在运行时而不是在编译时收到此错误，这意味着你仅在碰巧使用无效输入执行此代码时才注意到该错误。</p>
</blockquote>
<p>更糟糕的是，如果此代码位于应用程序内部，则运行时错误将导致应用程序崩溃！</p>
<p>你怎么能安全地玩呢？</p>
<p>要在此处停止运行时错误，你可以将检查可选包装的代码包装起来，如下所示：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> authorName != <span class="literal">nil</span> &#123;</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">"Author is \(authorName!)"</span>)</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"No author."</span>) </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>if语句检查可选值是否包含nil。 如果不是，则表示它包含你可以解开的值。</p>
<p>该代码现在是安全的，但仍然不够完美。 如果你依靠这项技术，则每次打开包装选件时都必须记住检查nil。 这将开始变得乏味，有一天你会忘记，并再次导致运行时错误。</p>
<p>然后回到绘图板！</p>
<h2 id="可选绑定"><a href="#可选绑定" class="headerlink" title="可选绑定"></a><em><strong>可选绑定</strong></em></h2><p>Swift包含称为可选绑定的功能，该功能使你可以安全地访问可选内部的值。 你可以这样使用它：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> <span class="keyword">let</span> unwrappedAuthorName = authorName &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"Author is \(unwrappedAuthorName)"</span>)</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"No author."</span>) </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>你会立即注意到这里没有感叹号。 此可选绑定摆脱了可选类型。 如果可选的值包含一个值，则该值将被解包并存储在常数unwrappedAuthorName中或绑定到该常数。 然后，if语句执行第一段代码，你可以在其中安全地使用unwrappedAuthorName，因为它是常规的非可选String。</p>
<p>如果可选参数不包含值，则if语句执行else块。 在这种情况下，unwrappedAuthorName变量甚至不存在。</p>
<p>你可以看到可选绑定比强制展开安全得多，并且在可选选项可能为nil时应使用它。 仅当保证可选值包含值时，才需要强制展开。</p>
<p>由于命名很困难，因此通常的做法是为解包后的常数赋予与可选名称相同的名称（从而为该可选名称添加阴影）：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> <span class="keyword">let</span> authorName = authorName &#123;</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">"Author is \(authorName)"</span>)</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"No author."</span>) </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>你甚至可以同时解开多个值，如下所示：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> <span class="keyword">let</span> authorName = authorName, <span class="keyword">let</span> authorAge = authorAge &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"The author is \(authorName) who is \(authorAge) years old."</span>)</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"No author or no age."</span>) </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这段代码解包了两个值。 当两个可选参数都包含一个值时，它将仅执行语句的if部分。</p>
<p>你可以将多个可选内容与其他布尔检查结合使用。 例如：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> <span class="keyword">let</span> authorName = authorName, <span class="keyword">let</span> authorAge = authorAge, authorAge &gt;= <span class="number">40</span> &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"The author is \(authorName) who is \(authorAge) years old."</span>)</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"No author or no age or age less than 40."</span>) </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在这里，你解开名称和年龄，并检查年龄是否大于或等于40。if语句中的表达式仅在name为非nil且age为非nil且age大于或大于or时才为true。 等于40。</p>
<p>现在，你知道如何安全地查看可选内容并提取其值（如果存在）。</p>
<h1 id="介绍guard"><a href="#介绍guard" class="headerlink" title="介绍guard"></a><strong>介绍guard</strong></h1><p>有时你想检查条件，仅在条件为真时才继续执行函数，例如使用可选参数时。 想象一下一个从网络中获取一些数据的函数。 如果网络中断，则获取可能会失败。 封装此行为的常用方法是使用可选参数，如果获取成功，则该参数将具有一个值，否则将为nil。</p>
<p>Swift具有有用而强大的功能，可以在以下情况下提供帮助：保护声明。 现在让我们用这个人为的例子来看看它：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">guardMyCastle</span><span class="params">(name: String?)</span></span> &#123;</span><br><span class="line">  <span class="keyword">guard</span> <span class="keyword">let</span> castleName = name <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"No castle!"</span>)</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// At this point, `castleName` is a non-optional String</span></span><br><span class="line">  <span class="built_in">print</span>(<span class="string">"Your castle called \(castleName) was guarded!"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>保护语句包括保护，后跟一个条件，该条件可以同时包含布尔表达式和可选绑定，其次是else，然后是代码块。如果条件为假，则else覆盖的代码块将执行。在条件为假的情况下执行的代码块必须返回。如果你不小心忘记了，编译器将阻止你-这是guard语句的真正美。你可能会听到程序员在谈论函数的“快乐之路”。这是你期望在大多数时间发生的路径。遵循的任何其他路径可能是由于错误或函数应返回比预期更早的其他原因所致。</p>
<p>Guard语句确保幸福的道路仍然在代码的左侧；这通常被认为是一件好事，因为它使代码更易于阅读和理解。另外，由于guard语句必须在false情况下返回，因此Swift编译器知道，如果条件为true，则在该函数的其余部分中，在guard语句的条件中检查的所有内容都必须为true。这意味着编译器可以进行某些优化。你无需了解这些优化的工作原理，甚至不必说它们是什么，因为Swift旨在为用户提供友好且快速的设计。</p>
<p>你可以简单地使用if-let绑定，并在nil为零的情况下返回。但是，当你使用Guard时，你明确表示如果Guard中的语句为false，则必须返回该值，因此编译器可以确保你已添加返回。编译器为你提供了一些不错的安全性！</p>
<p>让我们来看一个更“真实的世界”示例中的守卫。考虑以下功能：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">calculateNumberOfSides</span><span class="params">(shape: String)</span></span> -&gt; <span class="type">Int?</span> &#123; </span><br><span class="line">    <span class="keyword">switch</span> shape &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">"Triangle"</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">3</span></span><br><span class="line">        <span class="keyword">case</span> <span class="string">"Square"</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">4</span></span><br><span class="line">        <span class="keyword">case</span> <span class="string">"Rectangle"</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">4</span></span><br><span class="line">        <span class="keyword">case</span> <span class="string">"Pentagon"</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">5</span></span><br><span class="line">        <span class="keyword">case</span> <span class="string">"Hexagon"</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">6</span></span><br><span class="line">        <span class="keyword">default</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>此函数采用形状名称，并返回该形状具有的边数。 如果形状未知，或者你传递的不是形状，则返回nil。</p>
<p>你可以像这样使用此功能：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">maybePrintSides</span><span class="params">(shape: String)</span></span> &#123;</span><br><span class="line">    <span class="keyword">let</span> sides = calculateNumberOfSides(shape: shape)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">let</span> sides = sides &#123;</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"A \(shape) has \(sides) sides."</span>)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"I don’t know the number of sides for \(shape)."</span>) </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这没什么问题，它会起作用。</p>
<p>但是，可以使用如下保护语句编写相同的逻辑：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">maybePrintSides</span><span class="params">(shape: String)</span></span> &#123;</span><br><span class="line">    <span class="keyword">guard</span> <span class="keyword">let</span> sides = calculateNumberOfSides(shape: shape) <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"I don’t know the number of sides for \(shape)."</span>)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"A \(shape) has \(sides) sides."</span>) </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>当你的功能变得更加复杂时，Guard就会真正发挥作用。 你可能在功能顶部有多个保护装置，可以正确设置初始条件。 你会看到它在Swift代码中得到了广泛的使用。</p>
<h2 id="nil合并"><a href="#nil合并" class="headerlink" title="nil合并"></a><em><strong>nil合并</strong></em></h2><p>有一种非常方便的替代方法来解开可选项。 无论何时，只要你想从可选值中获取一个值，就可以使用它；对于nil，则使用默认值。 这称为nil合并。 运作方式如下：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> optionalInt: <span class="type">Int?</span> = <span class="number">10</span></span><br><span class="line"><span class="keyword">var</span> mustHaveResult = optionalInt ?? <span class="number">0</span></span><br></pre></td></tr></table></figure>

<p>nil合并发生在第二行，带有双问号（??），称为nil合并运算符。 这行意味着mustHaveResult将等于optionalInt内的值，或者如果optionalInt包含nil则为0。 在此的示例mustHaveResult包含具体的Int值10。</p>
<p>前面的代码等效于以下代码：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> optionalInt: <span class="type">Int?</span> = <span class="number">10</span></span><br><span class="line"><span class="keyword">var</span> mustHaveResult: <span class="type">Int</span></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">let</span> unwrapped = optionalInt &#123;</span><br><span class="line">    mustHaveResult = unwrapped</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    mustHaveResult = <span class="number">0</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>将optionalInt设置为nil，如下所示：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">optionalInt = <span class="literal">nil</span></span><br><span class="line">mustHaveResult = optionalInt ?? <span class="number">0</span></span><br></pre></td></tr></table></figure>

<p>现在mustHaveResult等于0。</p>
<h1 id="关键点"><a href="#关键点" class="headerlink" title="关键点"></a><strong>关键点</strong></h1><ul>
<li>nil表示没有值。</li>
<li>非可选变量和常量永远不会为零。</li>
<li>可选变量和常量类似于可以包含值或为空（零）的框。</li>
<li>要使用可选内部的值，必须首先将其从可选中解包。</li>
<li>解开可选值的最安全方法是使用可选绑定或零合并。 仅在适当时使用强制展开，因为这可能会产生运行时错误。</li>
<li>你可以保护let绑定可选项。 如果绑定失败，编译器将强制你退出当前函数（或暂停执行）。 这样可以确保你的程序永远不会使用未初始化的值执行。</li>
</ul>

    </div>

    
    
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- bottom ad -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-5714801576974230"
     data-ad-slot="5659053341"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
        <div class="reward-container">
  <div>坚持原创技术分享，您的支持将鼓励我继续创作！</div>
  <button onclick="var qr = document.getElementById('qr'); qr.style.display = (qr.style.display === 'none') ? 'block' : 'none';">
    打赏
  </button>
  <div id="qr" style="display: none;">
      
      <div style="display: inline-block;">
        <img src="/images/wechatpay.png" alt="Char 微信支付">
        <p>微信支付</p>
      </div>
      
      <div style="display: inline-block;">
        <img src="/images/alipay.png" alt="Char 支付宝">
        <p>支付宝</p>
      </div>

  </div>
</div>
  <div class="addthis_inline_share_toolbox">
    <script src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5eacc50f0dcd8169" async="async"></script>
  </div>

        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者： </strong>Char
  </li>
  <li class="post-copyright-link">
    <strong>本文链接：</strong>
    <a href="https://www.xuebaonline.com/Swift%20Apprentice%E7%B3%BB%E5%88%97%20(%E5%85%AD)%20:%20%E7%AC%AC%E4%B8%80%E9%83%A8%E5%88%86%EF%BC%9ASwift%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%20-%206%E3%80%81Optionals/" title="Swift Apprentice系列 (六) : 第一部分：Swift基础知识 - 6、Optionals">https://www.xuebaonline.com/Swift Apprentice系列 (六) : 第一部分：Swift基础知识 - 6、Optionals/</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/zh-CN" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>

        

  <div class="followme">
    <p>欢迎关注我的其它发布渠道</p>

    <div class="social-list">

        <div class="social-item">
          <a target="_blank" class="social-link" href="https://twitter.com/Bogon">
            <span class="icon">
              <i class="fab fa-twitter"></i>
            </span>

            <span class="label">Twitter</span>
          </a>
        </div>

        <div class="social-item">
          <a target="_blank" class="social-link" href="/images/connectme.JPG">
            <span class="icon">
              <i class="fab fa-weixin"></i>
            </span>

            <span class="label">WeChat</span>
          </a>
        </div>

        <div class="social-item">
          <a target="_blank" class="social-link" href="/atom.xml">
            <span class="icon">
              <i class="fa fa-rss"></i>
            </span>

            <span class="label">RSS</span>
          </a>
        </div>
    </div>
  </div>


      <footer class="post-footer">
          
          <div class="post-tags">
              <a href="/tags/iOS/" rel="tag"><i class="fa fa-tag"></i> iOS</a>
              <a href="/tags/Swift/" rel="tag"><i class="fa fa-tag"></i> Swift</a>
              <a href="/tags/Swift-5-0/" rel="tag"><i class="fa fa-tag"></i> Swift 5.0</a>
              <a href="/tags/Optionals/" rel="tag"><i class="fa fa-tag"></i> Optionals</a>
              <a href="/tags/Swift-Apprentice/" rel="tag"><i class="fa fa-tag"></i> Swift Apprentice</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/Swift%20Apprentice%E7%B3%BB%E5%88%97%20(%E4%BA%94)%20:%20%E7%AC%AC%E4%B8%80%E9%83%A8%E5%88%86%EF%BC%9ASwift%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%20-%205%E3%80%81Functions/" rel="prev" title="Swift Apprentice系列 (五) : 第一部分：Swift基础知识 - 5、Functions">
      <i class="fa fa-chevron-left"></i> Swift Apprentice系列 (五) : 第一部分：Swift基础知识 - 5、Functions
    </a></div>
      <div class="post-nav-item">
    <a href="/Swift%20Apprentice%E7%B3%BB%E5%88%97%20(%E4%B8%83)%20:%20%E7%AC%AC%E4%BA%8C%E9%83%A8%E5%88%86%EF%BC%9ACollection%20Types/" rel="next" title="Swift Apprentice系列 (七) : 第二部分：Collection Types">
      Swift Apprentice系列 (七) : 第二部分：Collection Types <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
    <div class="comments" id="valine-comments"></div>

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#介绍nil"><span class="nav-number">1.</span> <span class="nav-text">介绍nil</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#前哨值"><span class="nav-number">1.1.</span> <span class="nav-text">前哨值</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#引入optionals"><span class="nav-number">2.</span> <span class="nav-text">引入optionals</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#解包可选"><span class="nav-number">2.1.</span> <span class="nav-text">解包可选</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#强制解包"><span class="nav-number">2.2.</span> <span class="nav-text">强制解包</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#可选绑定"><span class="nav-number">2.3.</span> <span class="nav-text">可选绑定</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#介绍guard"><span class="nav-number">3.</span> <span class="nav-text">介绍guard</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#nil合并"><span class="nav-number">3.1.</span> <span class="nav-text">nil合并</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#关键点"><span class="nav-number">4.</span> <span class="nav-text">关键点</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Char"
      src="http://cdn.xuebaonline.com/blog_avatar.JPG">
  <p class="site-author-name" itemprop="name">Char</p>
  <div class="site-description" itemprop="description">曾经沧海难为水，除却巫山不是云。</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">176</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">67</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">143</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="sidebar-button motion-element">
    <a onclick="Chatra('openChat', true);"><i class="fa fa-comment"></i>
    联系我
  </a>
  </div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/Bogon" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;Bogon" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i></a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:zhangqixcu@gmail.com" title="E-Mail → mailto:zhangqixcu@gmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i></a>
      </span>
      <span class="links-of-author-item">
        <a href="https://weibo.com/u/5640441479" title="新浪微博 → https:&#x2F;&#x2F;weibo.com&#x2F;u&#x2F;5640441479" rel="noopener" target="_blank"><i class="fab fa-weibo fa-fw"></i></a>
      </span>
      <span class="links-of-author-item">
        <a href="https://blog.csdn.net/bogonbug" title="CSDN → https:&#x2F;&#x2F;blog.csdn.net&#x2F;bogonbug" rel="noopener" target="_blank"><i class="fab fa-skype fa-fw"></i></a>
      </span>
      <span class="links-of-author-item">
        <a href="https://twitter.com/Bogon" title="Twitter → https:&#x2F;&#x2F;twitter.com&#x2F;Bogon" rel="noopener" target="_blank"><i class="fab fa-twitter fa-fw"></i></a>
      </span>
      <span class="links-of-author-item">
        <a href="https://stackoverflow.com/users/4368897/qizhang" title="StackOverflow → https:&#x2F;&#x2F;stackoverflow.com&#x2F;users&#x2F;4368897&#x2F;qizhang" rel="noopener" target="_blank"><i class="fab fa-stack-overflow fa-fw"></i></a>
      </span>
  </div>


  <div class="links-of-blogroll motion-element">
    <div class="links-of-blogroll-title"><i class="fa fa-link fa-fw"></i>
      推荐阅读
    </div>
    <ul class="links-of-blogroll-list">
        <li class="links-of-blogroll-item">
          <a href="https://developer.apple.com/swift/" title="https:&#x2F;&#x2F;developer.apple.com&#x2F;swift&#x2F;" rel="noopener" target="_blank">Swift 5.4</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://developer.apple.com/documentation/objectivec" title="https:&#x2F;&#x2F;developer.apple.com&#x2F;documentation&#x2F;objectivec" rel="noopener" target="_blank">Objective-C</a>
        </li>
    </ul>
  </div>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- side ad -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-5714801576974230"
     data-ad-slot="8285216682"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        
  <div class="beian"><a href="https://beian.miit.gov.cn/" rel="noopener" target="_blank">豫ICP备20011156号-1 </a>
      <img src="/images/beian.png" style="display: inline-block;"><a href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=41172402000135" rel="noopener" target="_blank">豫公网安备41172402000135号 </a>
  </div>

<div class="copyright">
  
  &copy; 2021 – 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Char</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
    <span title="站点总字数">博客全站共1.5m字</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">23:04</span>
</div>

<!--
  <div class="addthis_inline_share_toolbox">
    <script src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5eacc50f0dcd8169" async="async"></script>
  </div>
-->

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>
  <script src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  
  <script>
    (function(){
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      bp.src = (curProtocol === 'https') ? 'https://zz.bdstatic.com/linksubmit/push.js' : 'http://push.zhanzhang.baidu.com/push.js';
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
    })();
  </script>




  
<script src="/js/local-search.js"></script>




  <script>
    (function(d, w, c) {
      w.ChatraID = 'PxGFNHLgjQ3C3Hmpo';
      var s = d.createElement('script');
      w[c] = w[c] || function() {
        (w[c].q = w[c].q || []).push(arguments);
      };
      s.async = true;
      s.src = 'https://call.chatra.io/chatra.js';
      if (d.head) d.head.appendChild(s);
    })(document, window, 'Chatra');
  </script>









  

  


<script>
NexT.utils.loadComments(document.querySelector('#valine-comments'), () => {
  NexT.utils.getScript('//unpkg.com/valine/dist/Valine.min.js', () => {
    var GUEST = ['nick', 'mail', 'link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item => {
      return GUEST.includes(item);
    });
    new Valine({
      el         : '#valine-comments',
      verify     : false,
      notify     : true,
      appId      : 'rfRdmQpsk2Crnz747tDDOu26-gzGzoHsz',
      appKey     : 'eyu1k9BeINgR5FuXzbc969UA',
      placeholder: "写出你的想法……",
      avatar     : 'mm',
      meta       : guest,
      pageSize   : '10' || 10,
      visitor    : false,
      lang       : 'zh-cn' || 'zh-cn',
      path       : location.pathname,
      recordIP   : true,
      serverURLs : ''
    });
  }, window.Valine);
});
</script>

<script async>window.onload=function(){var a=document.createElement('script'),b=document.getElementsByTagName('script')[0];a.type='text/javascript',a.async=!0,a.src='/sw-register.js?v='+Date.now(),b.parentNode.insertBefore(a,b)};</script></body></html>